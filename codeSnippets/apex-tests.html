<!DOCTYPE html>
<html lang="en-US" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- ===============================================-->
    <!--    Document Title-->
    <!-- ===============================================-->
    <title>Code Snippet - Apex Tests</title>
    <meta name="description"
        content="Nasir Watts is a seasoned Salesforce and Software Developer with extensive experience. Discover projects, skills, and professional journey on the site.">
    <meta name="keywords"
        content="Nasir Watts, Salesforce Developer, Software Developer, Tech Consultant, thetechconsultant.dev">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://thetechconsultant.dev/">
    <meta property="og:title" content="Nasir Watts - Salesforce and Software Developer">
    <meta property="og:description"
        content="Nasir Watts is a seasoned Salesforce and Software Developer with extensive experience. Discover projects, skills, and professional journey on the site.">
    <meta property="og:image" content="https://thetechconsultant.dev/assets/img/TheTechConsultant.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://thetechconsultant.dev/">
    <meta property="twitter:title" content="Nasir Watts - Salesforce and Software Developer">
    <meta property="twitter:description"
        content="Nasir Watts is a seasoned Salesforce and Software Developer with extensive experience. Discover projects, skills, and professional journey on the site.">
    <meta property="twitter:image" content="https://thetechconsultant.dev/assets/img/TheTechConsultant.png">


    <!-- ===============================================-->
    <!--    Favicons-->
    <!-- ===============================================-->
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/img/favicons/favicon-16x16.png">
    <link rel="shortcut icon" type="image/x-icon" href="../assets/img/favicons/favicon.jpg">
    <link rel="manifest" href="assets/img/favicons/manifest.json">
    <meta name="theme-color" content="#ffffff">


    <!-- ===============================================-->
    <!--    Stylesheets-->
    <!-- ===============================================-->
    <link
        href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900%7CNunito+Sans:300,400,700,900&amp;display=swap"
        rel="stylesheet">
    <link href="../assets/lib/prismjs/prism-okaidia.css" rel="stylesheet">
    <link href="../assets/lib/semantic-ui-accordion/accordion.min.css" rel="stylesheet">
    <link href="../assets/lib/semantic-ui-transition/transition.min.css" rel="stylesheet">
    <link href="../assets/css/theme.css" rel="stylesheet">

</head>


<body>

    <!-- ===============================================-->
    <!--    Main Content-->
    <!-- ===============================================-->
    <main class="main" id="top">


        <!-- ============================================-->
        <!-- <section> begin ============================-->
        <section class="bg-white pt-3 pb-0 d-none d-lg-block">

            <div class="container">
                <div class="row flex-center">
                    <div class="col-auto"><a class="navbar-brand-top" href="/"><img class="pt-2"
                                src="../assets/img/TheTechConsultant.png" alt="logo" width="340" /></a></div>
                </div>
            </div>
            <!-- end of .container-->

        </section>
        <!-- <section> close ============================-->
        <!-- ============================================-->


        <nav class="navbar navbar-raven navbar-expand-lg navbar-light bg-white font-weight-semi-bold text-base py-lg-0">
            <div class="container"><a class="navbar-brand d-lg-none" href="/"><img
                        src="../assets/img/TheTechConsultant.png" alt="logo" width="140" /></a>
                <button class="navbar-toggler collapsed" type="button" data-toggle="collapse"
                    data-target="#navbarStandard" aria-controls="navbarStandard" aria-expanded="false"
                    aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse justify-content-center position-relative" id="navbarStandard">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link py-lg-4" href="/" role="button">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link py-lg-4" href="../contact.html" role="button">Contact</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link py-lg-4" href="../about.html" role="button">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link py-lg-4" href="../gallery.html" role="button">Gallery</a>
                        </li>

                        <li class="nav-item dropdown dropdown-menu-on-hover"><a class="nav-link dropdown-toggle py-lg-4"
                                href="#!" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">Code Snippets</a>
                            <div class="dropdown-menu shadow-sm border-top-3x border-primary m-0 dropdown-menu-right">
                                <a class="dropdown-item" href="/codeSnippets/markup.html">HTML</a>
                                <a class="dropdown-item" href="/codeSnippets/style.html">CSS</a>
                                <a class="dropdown-item" href="/codeSnippets/javascript.html">JavaScript</a>
                                <a class="dropdown-item" href="/codeSnippets/ampscript.html">AMPscript</a>
                                <a class="dropdown-item" href="/codeSnippets/sosl.html">SOSL</a>
                                <a class="dropdown-item" href="/codeSnippets/soql.html">SOQL</a>
                                <a class="dropdown-item" href="/codeSnippets/apex.html">Apex</a>
                                <a class="dropdown-item" href="/codeSnippets/apex-tests.html">Apex Tests</a>
                                <a class="dropdown-item" href="/codeSnippets/django.html">Django</a>
                            </div>
                        </li>

                        <div class="dropdown-menu p-0 m-0" aria-labelledby="megamneu">
                            <div class="row justify-content-center">
                                <div
                                    class="col-xl-9 col-lg-10 px-0 border-top-3x border-primary m-0 bg-white rounded-soft shadow">
                                    <div class="row no-gutters">
                                        <div class="col-lg-6 order-1 bg-white rounded-soft rounded-top-0">
                                            <div class="row no-gutters py-4">
                                                <div class="col-6 col-sm-auto ml-4">
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            class="col-lg d-none d-lg-block order-0 rounded-right-0 overflow-hidden rounded-soft rounded-top-0">
                                            <div class="bg-holder"
                                                style="background-image:url(assets/img/gallery/mega-menu.jpg);">
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            </li>

                    </ul>
                </div>
            </div>
        </nav>


        <!-- ============================================-->
        <!-- <section> begin ============================-->

        <div class="container">
            <div class="row">
                <div class="col rounded-soft overflow-hidden">
                    <div class="bg-holder" style="background-image:url(../assets/img/bg-img/component-1.jpg);">
                    </div>
                    <!--/.bg-holder-->

    <div class="row">
    <div class="col-md-7 col-lg-6 px-0">
        <img class="img-fluid w-100" src="../assets/img/shapes/shape-component.png" alt="shape">
        <div class="row text-white">
            <div class="col-lg-8 col-md-9 col-10 absolute-centered" style="display: -webkit-box; -webkit-line-clamp: 15; -webkit-box-orient: vertical; overflow: hidden;overflow-y:auto;">
                <h1 class="text-white text-capitalize" style="padding-top:5px !important;">Apex Tests</h1>
                <p class="mb-0" style="font-size: 12px !important;">The Apex testing framework enables you to write and execute tests for your Apex classes and triggers on the Lightning Platform. 
                    They are used to validate the functionality of custom Apex code and ensure that the code meets the requirements and standards set by the organization.</p>
                <a class="btn btn-link btn-sm pl-0 mt-2 text-white" href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_testing.htm" target="_blank">Testing Apex<span class="fas fa-chevron-right ml-1 fs--2"></span>
                </a>
            </div>
        </div>
    </div>
</div>

                </div>
            </div>
            <div class="row mt-3 justify-content-center">
                <div class="col d-none d-lg-block px-0">
                    <div class="card shadow border-top-3x border-success" data-options='{"offset_top":95}'>
                        <div class="card-body">
                            <ul class="nav flex-column accordion font-weight-semi-bold" id="sidebar-nav">
                                <li class="nav-item"><a class="nav-link text-primary" data-toggle="collapse"
                                        href="#plugins" role="button" aria-expanded="true" aria-controls="plugins">Code
                                        Snippets<span class="fa fa-angle-down font-weight-bold collapse-icon"
                                            data-fa-transform="right-6 down-3"></span></a>
                                    <div class="nav collapse pl-3 show" id="plugins" data-parent="#sidebar-nav"><a
                                            class="nav-link w-100 py-0 text-600"
                                            href="../codeSnippets/markup.html">HTML</a><a
                                            class="nav-link w-100 py-0 text-600"
                                            href="../codeSnippets/style.html">CSS</a>
                                        <a class="nav-link w-100 py-0 text-600"
                                            href="../codeSnippets/javascript.html">JavaScript</a><a
                                            class="nav-link w-100 py-0 text-600"
                                            href="../codeSnippets/ampscript.html">AMPscript</a><a
                                            class="nav-link w-100 py-0 text-600"
                                            href="../codeSnippets/sosl.html">SOSL</a>
                                        <a class="nav-link w-100 py-0 text-600"
                                            href="../codeSnippets/soql.html">SOQL</a>
                                        <a class="nav-link w-100 py-0 text-600" href="../codeSnippets/apex.html">Apex</a>
                                        <a class="nav-link w-100 py-0 text-primary" href="../codeSnippets/apex-tests.html">Apex Tests</a>
                                            <a class="nav-link w-100 py-0 text-600" href="../codeSnippets/apex.html">Django</a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-10 col-lg-9 px-0 pl-lg-3">
                    <div class="card mb-3">
                        <div class="card-header" style="padding-bottom:0px !important;">
                            <h5 class="mb-0 font-weight-bold">Verify Date</h5>
                        </div>
                        <div class="card-body bg-light">
                            <pre class="mt-0"><code class="language-javascript">
public class VerifyDate {
	
	//method to handle potential checks against two dates
	public static Date CheckDates(Date date1, Date date2) {
		//if date2 is within the next 30 days of date1, use date2.  Otherwise use the end of the month
		if(DateWithin30Days(date1,date2)) {
			return date2;
		} else {
			return SetEndOfMonthDate(date1);
		}
	}
	
	//method to check if date2 is within the next 30 days of date1
	private static Boolean DateWithin30Days(Date date1, Date date2) {
		//check for date2 being in the past
        	if( date2 < date1) { return false; }
        
        	//check that date2 is within (>=) 30 days of date1
        	Date date30Days = date1.addDays(30); //create a date 30 days away from date1
		if( date2 >= date30Days ) { return false; }
		else { return true; }
	}

	//method to return the end of the month of a given date
	private static Date SetEndOfMonthDate(Date date1) {
		Integer totalDays = Date.daysInMonth(date1.year(), date1.month());
		Date lastDay = Date.newInstance(date1.year(), date1.month(), totalDays);
		return lastDay;
	}

}
                    </code></pre>
                        </div>

                    <div class="card mb-3">
                        <div class="card-header" style="padding-bottom:0px !important;">
                            <h5 class="mb-0 font-weight-bold">Testing Verify Date</h5>
                            <h6 class="mb-0 font-weight-bold" style="padding-top:5px;">
                           Here is an example of how you can write the test class named <i>TestVerifyDate</i> for the <i>VerifyDate</i> class. 
                           In order to cover all paths and achieve 100% code coverage, you need to cover both the cases where <i>date2</i> is within 30 days of <i>date1</i> and when it is not.
                            </h6>
                        </div>
                        <div class="card-body bg-light">
                            <pre class="mt-0"><code class="language-javascript">
@isTest
public class TestVerifyDate {
    // test when date2 is within 30 days of date1
    @isTest
    static void testDateWithin30Days() {
        Date date1 = Date.today();
        Date date2 = Date.today().addDays(10); // within 30 days

        Date result = VerifyDate.CheckDates(date1, date2);
        System.assertEquals(date2, result, 'Date2 is within 30 days of Date1 so it should be returned');
    }

    // test when date2 is not within 30 days of date1
    @isTest
    static void testDateNotWithin30Days() {
        Date date1 = Date.today();
        Date date2 = Date.today().addDays(35); // more than 30 days

        Date result = VerifyDate.CheckDates(date1, date2);

        Integer totalDays = Date.daysInMonth(date1.year(), date1.month());
        Date lastDayOfMonth = Date.newInstance(date1.year(), date1.month(), totalDays);

        System.assertEquals(lastDayOfMonth, result, 'Date2 is not within 30 days of Date1 so end of the month should be returned');
    }
    
    // test when date2 is before date1
    @isTest
    static void testDate2BeforeDate1() {
        Date date1 = Date.today();
        Date date2 = Date.today().addDays(-5); // before date1

        Date result = VerifyDate.CheckDates(date1, date2);

        Integer totalDays = Date.daysInMonth(date1.year(), date1.month());
        Date lastDayOfMonth = Date.newInstance(date1.year(), date1.month(), totalDays);

        System.assertEquals(lastDayOfMonth, result, 'Date2 is before Date1 so end of the month should be returned');
    }
}

                    </code></pre>
    <br>In this test class, we have three methods. The first method tests the condition where <i>date2</i> is within 30 days of date1. 
    The second method tests the condition where <i>date2</i> is more than 30 days away from date1, and the third method tests the condition where <i>date2</i> is before <i>date1</i>. The <i>System.assertEquals</i> method is used to assert that the actual result matches the expected result.
    After writing your tests, be sure to run them and check the code coverage in the Developer Console or your Salesforce IDE to make sure you have achieved 100% coverage.
                        </div>

                           

<div class="card mb-3">
    <div class="card-header" style="padding-bottom:0px !important;">
        <h5 class="mb-0 font-weight-bold">Account Address Trigger</h5>
    </div>
    <div class="card-body bg-light">
        <pre class="mt-0"><code class="language-javascript">
//Create an Apex Trigger with the following information:
//Object: Account
//Events: Before Insert and Before Update
//Condition: Match Billing Address is true
//Operation: Set the Shipping Postal Code to the Billing Postal Code

trigger AccountAddressTrigger on Account (before insert, before update) {
    for (Account a : Trigger.new) {
        if (a.Match_Billing_Address__c == true) {
            a.ShippingPostalCode = a.BillingPostalCode;
        }
    }
}
        </code></pre>
</div>


<div class="card mb-3">
    <div class="card-header" style="padding-bottom:0px !important;">
        <h5 class="mb-0 font-weight-bold">Apex bulkified</h5>
        <h6 class="mb-0 font-weight-bold" style="padding-top:5px;">
            In the following code example, 
            the trigger written is bulkified, meaning it can handle multiple records at a time, up to Salesforce's governor limit of 200 records per transaction.
            This code correctly uses a `list (List<Task> tasks = new List<Task>();)` to accumulate tasks and then performs a single DML operation `(insert tasks;)` outside of the loop. 
            This is an example of bulkification, because it means your code only executes one DML operation regardless of the number of records processed. 
            </h6>
    </div>
    <div class="card-body bg-light">
        <pre class="mt-0"><code class="language-javascript">
//Create an Apex trigger with the following information:
//Object: Opportunity
//Name: ClosedOpportunityTrigger
//Events: After Insert and After Update
//Conditions: Stage is Closed Won
//Operation: Create a task with the following information:
//Subject: Follow Up Test Task
//WhatId: Opportunity ID (associates the task with the opportunity)
//Bulkification: The trigger should be bulkified so that it can insert or update up to 200 records at a time.

trigger ClosedOpportunityTrigger on Opportunity (after insert, after update) {
    List<Task> tasks = new List<Task>();
    for(Opportunity opp : Trigger.new){
        // Check if the StageName has changed to 'Closed Won'
        if(opp.StageName == 'Closed Won' && (Trigger.isInsert || opp.StageName != Trigger.oldMap.get(opp.Id).StageName)){
            Task t = new Task();
            t.Subject = 'Follow Up Test Task';
            t.WhatId = opp.Id;
            tasks.add(t);
        }
    }
    insert tasks;
}
        </code></pre>
        <p>Instead of only checking if the `StageName` is `Closed Won`, which means it creates tasks for all opportunities that are inserted or updated 
            with that stage, even if they were already `Closed Won` before the update, you'd only want to create tasks when an opportunity is closed, not every time a `Closed Won` opportunity is updated.
            Remember, while Salesforce allows you to process up to 200 records at a time, you should always write your code to handle bulk operations using collections like lists, sets, and maps to avoid hitting governor limits.
        </p>
</div>


                    <div class="card mb-3">
                        <div class="card-header" id="blog">
                            <h5 class="mb-0 font-weight-bold">Most Asked Questions about Testing Apex</h5>
                        </div>
                        <div class="card-body bg-light">
                            <div class="ui styled fluid accordion" data-options='{"exclusive":true}'>
                                <div class="active title"><i class="dropdown icon"></i>Can we test asynchronous Apex using Salesforce Apex Test classes?</div>
                                <div class="active content">
                                    <p>Yes, you can test asynchronous Apex code like future methods, batch Apex, and scheduled Apex. 
                                        Salesforce provides a Test method called `Test.startTest()` and `Test.stopTest()` which allows the system to execute asynchronous code synchronously for testing purposes. 
                                        When you call `Test.stopTest()`, all asynchronous processes kicked off after `Test.startTest()` are collected and executed before the test method finishes.</p>
                                </div>
                                <div class="title"><i class="dropdown icon"></i>How can we handle test data setup for managed packages in Apex?</div>
                                <div class="content">
                                    <p>Test data setup for managed packages can be quite challenging, especially since the Apex <i>SeeAllData</i> annotation is set to false by default in order to ensure test isolation. 
                                        It means tests do not have access to pre-existing data in the organization, such as standard Salesforce objects and custom objects. 
                                        If you're developing a managed package, it's good practice to include Apex classes that provide setup methods specifically for generating test data. 
                                        These can be used by any test methods included in the package, which helps in ensuring consistency and reducing redundancy.</p>
                                </div>
                                <div class="title"><i class="dropdown icon"></i>How does Governor Limits impact testing in Apex?</div>
                                <div class="content">
                                    <p>Apex tests are subjected to Governor Limits, just like non-test classes. 
                                        Salesforce enforces a number of runtime limits to ensure that runaway Apex doesn't monopolize shared resources. Tests that exceed governor limits fail. 
                                        However, the `Test.startTest()` and `Test.stopTest()` methods give you a new set of governor limits during the test execution. 
                                        Any code that is executed after the `Test.startTest()` method is subject to a fresh set of governor limits. 
                                        This can be used strategically in tests to ensure that you have enough resources to test bulk or complex operations.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- ============================================-->
        <!-- <section> begin ============================-->

        <!-- end of .container-->

        </section>
        <!-- <section> close ============================-->
        <!-- ============================================-->




        <!-- ============================================-->
        <!-- <section> begin ============================-->
        <section class="p-0">

            <div class="container">
                <div class="row justify-content-center">
                    <div class="col text-center border-top border-200 py-4"><a href="/"><img class="img-fluid mb-2"
                                src="../assets/img/TheTechConsultant.png" alt="" width="220" /></a>
                        <p class="fs--1 my-0">© All rights Reserved. 2023</p>
                    </div>
                </div>
            </div>
            <!-- end of .container-->

        </section>
        <!-- <section> close ============================-->
        <!-- ============================================-->

        <a class="bottom-to-top rounded-soft" href="#top" data-fancyscroll><span class="fas fa-angle-up"
                data-fa-transform="down-2"></span></a>
    </main>
    <!-- ===============================================-->
    <!--    End of Main Content-->
    <!-- ===============================================-->




    <!-- ===============================================-->
    <!--    JavaScripts-->
    <!-- ===============================================-->
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/popper.min.js"></script>
    <script src="../assets/js/bootstrap.js"></script>
    <script src="../assets/js/plugins.js"></script>
    <script src="../assets/lib/is/is.min.js"></script>
    <script src="../assets/lib/stickyfilljs/stickyfill.min.js"></script>
    <script src="../assets/lib/sticky-kit/sticky-kit.min.js"></script>
    <script src="../assets/lib/prismjs/prism.js"></script>
    <script src="../assets/lib/semantic-ui-accordion/accordion.min.js"></script>
    <script src="../assets/lib/semantic-ui-transition/transition.min.js"></script>
    <script src="../assets/lib/zion-semantic-ui-accordion/js/plugin.min.js"></script>
    <script src="../assets/js/theme.js"></script>

</body>

</html>